/*
*	(C)2009-2013 VeryIDE
*	Mo.js
*	author:
*			Wiki[MO]	gwikimo@gmail.com	
*			Lay 		veryide@qq.com
*
*	#表单扩展，包括表单验证、序列化、配置项等#
*/
if(typeof Mo!="function"){var Mo={plugin:[]}}function isDOBvalid(e,c,a,b){var d=new Array(31,28,31,30,31,30,31,31,30,31,30,31);if(a.value%4==0){d[1]=29}if(e.value>d[c.value-1]){d[1]=28;alert("Enter Valid Date "+b);e.focus();return false}}function switchChar(e){var d="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var c="１２３４５６７８９０ａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ";var a=e.length;for(var b=0;b<a;b++){var f=c.indexOf(e.charAt(b));if(f!=-1){e=e.replace(e.charAt(b),d.charAt(f))}}return e}Mo.Password=function(c,a){if(typeof a!="function"){var a=function(){}}var i=["极佳","很好","一般","简单"];var b=[40,30,20,0];var h=[1,2,5];var e=[0,0,10,20];var d=[/[a-zA-Z]/g,/\d/g,/[^a-zA-Z0-9]/g];var g=function(p){var l=0;var m=0;for(var n=0;n<d.length;n++){var o=p.match(d[n]);if(o!=null){l+=o.length*h[n];m++}}l+=e[m];return l};var j=function(n){var m=g(n);for(var l=0;l<b.length;l++){if(m>=b[l]){return{level:i[l],pos:l}}}};var f=j(c);a(g(c),f.level,f.pos)};Mo.Serialize=function(b,d,m,g){if(typeof d!="function"){var d=function(i){return encodeURIComponent(i)}}var j=g?g:"";var e={};var h=b.elements.length;for(var f=0;f<h;f++){var p=b.elements[f];var o=d(p.name);var c=p.value;if(!o){continue}if(/(text|textarea|password|hidden|file)/.test(p.type)){e[j+o]=d(c)}else{switch(p.type){case"select-one":var a=p[p.selectedIndex];e[j+o]=d(a.attributes&&a.attributes.value&&!(a.attributes.value.specified)?a.text:a.value);break;case"select-multiple":for(var n=0;n<p.length;n++){if(p[n].selected){e[j+o]=d(p[n].value)}}break;case"radio":if(p.checked){e[j+o]=d(p.value)}break;case"checkbox":if(p.checked){e[j+o]=d(p.value)}break}}}if(m){var l="";for(var o in e){l+=m+o+"="+e[o]}e=l}return e};Mo.Config=function(value){this.Value=value;this.Length=0;this.JSON="";this.Array=[];if(!this.Value){this.Value="{}"}this.JSON=eval("("+this.Value+")");var self=this;this.setJSON=function(){for(var k in self.JSON){if(k=="*"&&self.Array[k]=="*"){delete self.JSON[k];continue}self.Array[k]=self.JSON[k];self.Length++}}();this.getJSON=function(){var json="";var i=1;for(k in this.Array){if(k=="*"&&this.Array[k]=="*"){this.Length=this.Length-1;delete this.Array[k];continue}json+='"'+k+'":"'+this.Array[k].toString().replace(/"/g,'\\"').replace(/(\r\n)/g,"<br />")+'"'+(this.Length>i?",":"");i++}return"{"+(json.substr(json.length-1)==","?json.substr(0,json.length-1):json)+"}"};this.getValue=function(key){return this.Array[key]};this.setValue=function(action,key,value,func){if(action){if(!this.Array[key]){this.Length++}this.Array[key]=value.toString()}else{if(this.Array[key]){delete this.Array[key];this.Length--}}if(typeof func=="function"){func(this.getJSON())}}};Mo.ValidForm=function(e,d){if(typeof d!="function"){var d=function(h){alert(h)}}var a=e.elements.length;for(var c=0;c<a;c++){var g=e.elements[c];var b=g.getAttribute("data-valid-name");var f=g.getAttribute("placeholder");if(f&&g.value==f){g.value=""}if(!b){continue}if(g.disabled===true){continue}if(Mo.ValidForm.Element(g,d)===false){return false}}return true};Mo.ValidForm.Element=function(p,h){var I=p.getAttribute("data-valid-name");var J=p.value;var c=p.type;var z=p.id;var K=p.name;var g="";if(Mo.Array(["text","textarea","password","hidden","file"]).indexOf(c)>-1){var w=Mo.Validate.Empty(Mo.String(J).trim().output());var v=Mo.String(J).length();var n=p.getAttribute("data-valid-empty");if(n=="yes"&&w){g=I+" 不能为空! "}if(c=="password"){var t=p.getAttribute("data-valid-password");if(t&&Mo(t).size()&&Mo(t).value()!=J){g=I+" 输入有误! "}p.setAttribute("data-valid-empty","yes")}var s=p.getAttribute("data-valid-confirm");if(s&&Mo(s).value()!=J){g=I+" 输入有误! "}var y=p.getAttribute("data-valid-accept");var y=y?y.replace(/[,|，]/ig," "):"";if(n=="yes"&&y&&Mo.Array(y.split(" ")).indexOf(p.value.replace(/.*\./,"").toLowerCase())==-1){g=I+" 不支持此类型文件! "}var E=p.getAttribute("data-valid-minsize");if(v<parseInt(E)){g=I+" 未到最小长度："+E}var G=p.getAttribute("data-valid-maxsize");if(v>parseInt(G)){g=I+" 超出最大长度："+G}var d=p.getAttribute("data-valid-secure");if((d=="yes"&&!Mo.Validate.Safe(J))||(d=="no"&&!w&&!Mo.Validate.Safe(J))){g=I+" 存在非法字符! "}var r=p.getAttribute("data-valid-email");if((r=="yes"&&!Mo.Validate.Email(J))||(r=="no"&&!w&&!Mo.Validate.Email(J))){g=I+" 应为电子邮件地址! "}var a=p.getAttribute("data-valid-ip");if((a=="yes"&&!Mo.Validate.IP(J))||(a=="no"&&!w&&!Mo.Validate.IP(J))){g=I+" 应为IP地址! "}var m=p.getAttribute("data-valid-url");if((m=="yes"&&!Mo.Validate.URL(J))||(m=="no"&&!w&&!Mo.Validate.URL(J))){g=I+" 应为URL地址! "}var u=p.getAttribute("data-valid-number");if((u=="yes"&&!Mo.Validate.Number(J))||(u=="no"&&!w&&!Mo.Validate.Number(J))){g=I+" 应为数字! "}var l=p.getAttribute("data-valid-idcard");if((l=="yes"&&!Mo.Validate.ID(J))||(l=="no"&&!w&&!Mo.Validate.ID(J))){g=I+" 应为身份证号码! "}var C=p.getAttribute("data-valid-phone");if((C=="yes"&&!Mo.Validate.Phone(J))||(C=="no"&&!w&&!Mo.Validate.Phone(J))){g=I+" 应为电话号码! "}var B=p.getAttribute("data-valid-mobile");if((B=="yes"&&!Mo.Validate.Mobile(J))||(B=="no"&&!w&&!Mo.Validate.Mobile(J))){g=I+" 应为手机号码! "}var H=p.getAttribute("data-valid-datetime");if((H=="yes"&&!Mo.Validate.Date(J))||(H=="no"&&!w&&!Mo.Validate.Date(J))){g=I+" 应为日期格式! "}var j=p.getAttribute("data-valid-regexp");if(j&&J){var A=new RegExp(j);if(!A.test(J)){g=I+" 格式不匹配! "}}}else{switch(c){case"select-one":var J=Mo(p).value();if(J==""&&p.getAttribute("data-valid-empty")=="yes"){g=" 请选择 "+I}break;case"radio":var J=Mo("input[name='"+K+"']").value();if(J==""&&p.getAttribute("data-valid-empty")=="yes"){g=" 请选择 "+I}break;case"checkbox":var q=Mo("input[name='"+K+"']");var o=0;for(var D=0;D<q.size();D++){if(q.item(D).checked){o++}}var n=p.getAttribute("data-valid-empty");if(n=="yes"&&o==0){g=I+" 不能为空! "}var f=p.getAttribute("data-valid-maxsize");var b=p.getAttribute("data-valid-minsize");if(f&&f<o){g=I+" 最多只能选 "+f+" 项! "}if(b&&b>o){g=I+" 至少需要选 "+b+" 项! "}break}}if(g){if(c!="hidden"){try{p.focus()}catch(F){}}h(g,p);return false}return true};Mo.plugin.push("form");